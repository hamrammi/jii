(function(){"use strict";var r="0.6.5";var e=this;var t=Array.prototype,n=String.prototype,i=Array.prototype.unshift,a=Object.prototype.toString;var u=function(r){return new U(r)};u.fn=u.prototype;u.VERSION=r;var o="[object Array]",f="[object String]",c="[object Number]",l="[object Object]",s="[object Function]",h="[object Boolean]",p="[object Null]",v="[object RegExp]",g="[object global]";var y=false;var m=u.isArray=function(r){return typeof r==="object"&&r!==null&&Array.isArray(r)};var d=u.isNumber=function(r){return a.call(r)===c};var b=u.isString=function(r){return a.call(r)===f};var w=u.isObject=function(r){return typeof r==="object"&&r!==null&&!Array.isArray(r)};var C=u.isFunction=function(r){return a.call(r)===s};var j=u.isBoolean=function(r){return a.call(r)===h};var k=u.isNull=function(r){return a.call(r)===p};var x=u.isRegExp=function(r){return a.call(r)===v};var A=u.isGlobal=function(r){return a.call(r)===g};var E=function(r,e,t){if(m(r)){r=r.join(" or ")}throw new TypeError('"jii.'+t+'": expected "'+r+'",'+' got "'+e+'"')};var z=function(r,e){throw new Error('"jii.'+r+'" says: "'+e+'"')};var O=function(r,e,t){var n=typeof e;if(n!==t){var i='"jii.'+r+'": expected "'+t+'", got "'+n+'"';throw new TypeError(i)}return e};var S=function(r,e){var t=a.call(e);switch(t){case f:break;case o:break;default:O(r,e,"string or array")}return e};u.capitalize=function(r,e){r=O("capitalize",r,"string");e=e||null;var t;if(!e){return r.charAt(0).toUpperCase()+r.slice(1)}var n=[];e=O("capitalize",e,"number");for(t=0;t<e;t++){n[t]=r.charAt(t).toUpperCase()}return n.join("")+r.slice(e)};u.swapCase=function(r){r=O("swapCase",r,"string");var e=function(r){return u.isUpperCased(r)?r.toLowerCase():r.toUpperCase()};return u.walk(r,e)};u.isUpperCased=function(r){var e,t=r.length;for(e=0;e<t;e++){if(!r[e].match(/[A-ZА-Я]+/)){return false}}return true};u.isLowerCased=function(r){var e,t=r.length;for(e=0;e<t;e++){if(!r[e].match(/[a-zа-я]+/)){return false}}return true};u.toUnicode=function(r){var e;return u.walk(r,function(r){e=r.charCodeAt(0).toString(16);while(e.length<4){e="0"+e}return"\\u"+e})};u.toCharCode=function(r){return u.walk(r,function(r){return"\\x"+r.charCodeAt(0).toString(16)})};u.toCamelCase=function(r){var e=function(r,e){return e.toUpperCase()};return r.replace(/\s/g,"").replace(/[\-_](\w)/g,e)};u.endsWith=function(r,e,t){r=O("endsWith",r,"string");e=e||null;t=t||false;var n=r.length,i=typeof e;if(e){if(i==="string"){if(t){var a=r.slice(n-e.length).toLowerCase();return a===e.toLowerCase()}return r.slice(n-e.length)===e}if(i==="number"){if(!t){if(e>r.length){z("endsWith","string length exceeded")}return r.slice(r.length-e)}E("string","number","endsWith")}E(["string","number"],i,"endsWith")}return r.charAt(n-1)};u.startsWith=function(r,e,t){r=O("startsWith",r,"string");e=e||null;t=t||false;var n=0,i=typeof e;if(e){if(i==="string"){n=e.length;if(t){return r.slice(0,n).toLowerCase()===e.toLowerCase()}return r.slice(0,n)===e}if(i==="number"){if(!t){if(e>r.length){z("startsWith","string length exceeded")}return r.slice(0,e)}E("string","number","startsWith")}E(["string","number"],i,"endsWith")}return r.charAt(0)};u.positions=function(r,e){r=O("position",r,"string");e=O("position",e,"string");var t=[];u.map(r,function(r,n){if(r===e){t.push(n)}});return t};u.reverse=function(r){r=O("reverse",r,"string");var e="",t,n=r.length-1;for(t=0;t<=n;t++){e+=r.charAt(n-t)}return e};u.trim=function(r,e){r=O("trim",r,"string");e=e?O("trim",e,"string"):"both";switch(e){case"both":return r.replace(/^\s+|\s+$/g,"");case"left":return r.replace(/^\s+/,"");case"right":return r.replace(/\s+$/,"");case"full":return r.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ");default:throw new Error('"jii.trim": unexpected param "'+e+'"')}};u.title=function(r){r=O("title",r,"string");var e=function(r){return u.capitalize(r)};return r.replace(/[^\s]+/gm,e)};var W=function(r,e){var t,n,i,l;var s=function(r,e){var t,n,i=r.length,a=r[0].length;if(i===1){return r[0]}for(n=0;n<i;n++){if(e==="max"){if(a<=r[n].length){t=r[n];a=r[n].length}}if(e==="min"){if(a>=r[n].length){t=r[n];a=r[n].length}}}return t};switch(a.call(r)){case o:i=r[0];n=r.length;var h=a.call(i);if(h===c){for(t=0;t<n;t++){if(typeof r[t]!=="number"){E("number",typeof r[t],"core::value")}if(e==="max"){i=i>r[t]?i:r[t]}if(e==="min"){i=i<r[t]?i:r[t]}}}if(h===f||h===o){return s(r,e)}break;case f:l=u.trim(r,"full").split(" ");n=l.length;return s(l,e);default:E("string or array",typeof r,"core::value")}return i};u.similar=function(r,e){if(!m(r)){E("array",typeof r,"similar")}var t,n=true,i=r.length;if(i!==e.length){return false}for(t=0;t<i;t++){if(!u.has(e,r[t])){n=false;break}}return n};u.max=function(r){return W(r,"max")};u.min=function(r){return W(r,"min")};u.zip=function(r,e){if(!m(r)||!m(e)){E("array",[typeof r,typeof e],"zip")}if(r.length!==e.length){z("zip","arrays are not the same length")}var t=[],n,i;for(n=0,i=r.length;n<i;n++){t.push([r[n],e[n]])}return t};u.map=function(r,e,n){var i=[];if(r==null){return i}if(t.map){if(b(r)){return t.map.call(r,e)}return r.map(e,n)}var a=function(r,t,a){i[t]=e.call(n,r,t,a)};u.each(r,a);return i};u.hasChain=function(r,e,t){if(!w(r)){E("object",typeof r,"hasChain")}e=O("hasChain",e,"string");t=t||null;var n=e.split(".");var i=r,a,u;for(a=0,u=n.length;a<u;a++){i=i[n[a]];if(i===undefined){if(t&&typeof t==="function"){return t(true,null)}return false}}if(t&&typeof t==="function"){return t(false,i)}return i};u.select=u.filter=function(r,e,n){if(!m(r)){E("array",typeof r,"select")}if(t.filter){return r.filter(e,n)}var i=[];u.map(r,function(r){if(e.call(n,r)===true){i.push(r)}});return i};u.reject=function(r,e,t){if(!m(r)){E("array",typeof r,"reject")}var n=[];u.map(r,function(r){if(e.call(t,r)===false){n.push(r)}});return n};u.flatten=function(r,e){if(!m(r)){E("array",typeof r,"flatten")}e=e||null;var t=[],n=0;var i=function(r){if(m(r)){n++;if(!e||e&&e>=n){u(r).map(i);n=0}else{t.push(r)}}else{t.push(r)}};u(r).map(i);return t};u.reduce=function(r,e,t,n){if(!m(r)){E("array",typeof r,"reduce")}var i,a=!!t;if(t===0){a=!a}if(a){i=t}var o=function(r,t,u){if(a){i=e.call(n,i,r,t,u)}else{i=r;a=true}};u.each(r,o);if(!a){z("reduce","reduce of empty array with no initial value")}return i};u.sum=function(r){if(!m(r)){E("array",typeof r,"sum")}var e=function(r,e){return r+e};return u.reduce(r,e)};u.multiply=function(r){if(!m(r)){E("array",typeof r,"multiply")}var e=function(r,e){return r*e};return u.reduce(r,e)};u.all=u.every=function(r,e,n){if(!m(r)){E("array",typeof r,"all(every)")}if(t.every){return r.every(e,n)}var i=true,a=r.length;while(a--){if(!e.call(n,r[a],a,r)){i=false;break}}return i};u.any=u.some=function(r,e,n){if(!m(r)){E("array",typeof r,"any(some)")}if(t.some){return r.some(e,n)}var i=false,a=r.length;while(a--){if(e.call(n,r[a],a,r)){i=true;break}}return i};u.permutations=function(r,e){if(!m(r)){E("array",typeof r,"permutations")}var t=r.length,n=[],i=[];e=e||t;if(e>t){z("permutations","no permutations with length "+e)}var a=function(r){var e,t,u;for(e=0,t=r.length;e<t;e++){u=r.splice(e,1)[0];n.push(u);if(r.length===0){i.push(n.slice())}a(r);r.splice(e,0,u);n.pop()}};if(e===t){a(r)}else{var o=u.eachCons(r,e,true);u.forEach(o,a)}return i};u.combinations=function(r){var e=[];var t=function(r,n){if(!r.length){e.push(n)}else{var i,a;for(i=0,a=r[0].length;i<a;i++){t(r.slice(1),n.concat(r[0][i]))}}};t(r,[]);return e};u.size=function(r){var e=0,t;for(t in r){if(r.hasOwnProperty(t)){e++}}return e};u.occurrences=function(r,e){e=e||null;r=S("occurrences",r);var t={},n,i;for(n=0,i=r.length;n<i;n++){t[r[n]]=t[r[n]]?t[r[n]]+1:1}if(e){return t[e]}return t};u.uniq=function(r){var e=[];if(!(b(r)||m(r))){O("uniq",r,"string or array")}var t=function(r){if(!u.has(e,r)){e.push(r)}};u.each(r,t);return typeof r==="string"?e.join(""):e};u.count=function(r,e,t){t=t||false;var n=0;var i=function(r){if(!b(r)){E("string",typeof r,"count")}if(r.match(e)){n++}};var a=function(r){var i=function(e){if(e===r){n++}};if(t){e=u.uniq(e)}u.each(e,i)};var o=function(r){if(r===e){n++}};if(x(e)){u.each(r,i)}if(m(e)){u.each(r,a)}if(b(e)){u.each(r,o)}return n};u.eachSlice=function(r,e){r=S("eachSlice",r);var t=[],n=r.length,i=0;var a=Math.floor(n/e)+1;if(e<=0){z("eachSlice","number should be positive")}if(e===n){a--}if(e>n){e=n}while(a--){t.push(r.slice(i,i+e));i+=e}return t};u.eachCons=function(r,e,t){r=S("eachCons",r);var n=[],i=r.length,a=0;if(e<=0){z("eachCons","number should be positive")}if(e>i){e=i}t=t||false;while(a+e<=i){n.push(r.slice(a,a+e));a++}if(t){while(a<i){n.push(r.slice(a).concat(r.slice(0,e-(i-a))));a++}}return n};u.dropFirst=function(r,e){if(!e||e<=0){return z("dropFirst","number should be positive")}switch(a.call(r)){case f:return n.slice.call(r,e);case o:return t.slice.call(r,e);default:return E("string or array",typeof r,"dropFirst")}};u.dropLast=function(r,e){if(!e||e<=0){return z("dropLast","number should be positive")}switch(a.call(r)){case f:return n.slice.call(r,0,-e);case o:return t.slice.call(r,0,-e);default:return E("string or array",typeof r,"dropFirst")}};u.compact=function(r){var e=function(r){return!!r};return u.select(r,e)};u.each=u.forEach=function(r,e,n){var i=function(){var t,i;for(t=0,i=r.length;t<i;t++){e.call(n,r[t],t,r)}};switch(a.call(r)){case o:if(t.forEach){r.forEach(e,n)}else{i()}break;case f:i();break;case l:var u;for(u in r){if(r.hasOwnProperty(u)){e.call(n,r[u],u,r)}}break;default:O("each(forEach)",r,"string or array or object")}};var L=function(r,e){var t,n=true;for(t in e){if(e.hasOwnProperty(t)){if(!r.hasOwnProperty(t)){return false}if(r[t]!==e[t]){if(!u.isEqual(r[t],e[t])){n=false}}}}return n};u.has=function(r,e,t){var n;t=t||false;switch(a.call(r)){case f:if(b(e)){return r.indexOf(e)!==-1}return false;case l:if(w(e)){return L(r,e)}return false;case o:if(b(e)||d(e)||j(e)){return r.indexOf(e)!==-1}var i=function(){var i,a=r.length;n=false;for(i=0;i<a;i++){if(n){break}if(t){if(w(r[i])&&u.has(r[i],e,t)){n=true}}else{if(u.isEqual(r[i],e)){n=true}}}return n};if(m(e)||w(e)||C(e)){return i()}return false;default:return O("has",r,"string or array or object")}};u.in=function(r,e){return u.has(e,r)};u.isEqual=function(r,e){if(a.call(r)!==a.call(e)){return false}if(A(r)){return true}if(w(r)){return u.size(r)===u.size(e)?u.has(r,e):false}if(m(r)){if(r.length!==e.length){return false}var t,n;for(t=0,n=r.length;t<n;t++){if(!u.isEqual(r[t],e[t])){return false}}return true}if(C(r)){return r.toString()===e.toString()}return r===e};u.walk=function(r,e,t){var n;switch(a.call(r)){case f:var i,c;n="";for(i=0,c=r.length;i<c;i++){n+=e.call(t,r[i])}break;case o:n=u.map(r,e,t);break;default:E("string or array",typeof r,"walk")}return n};u.time=function(r,e,t,n){n=n||r;t=t||false;var i=(new Date).getTime();r.call(n,e);if(!t){console.log('"jii.time" time: '+((new Date).getTime()-i))}else{t('"jii.time" time: '+((new Date).getTime()-i))}};u.proto=function(){var r=["capitalize","swapCase","isUpperCased","isLowerCased","toUnicode","toCharCode","endsWith","startsWith","positions","reverse","trim","title"];var e=["occurrences","uniq","count","eachSlice","eachCons","dropFirst","dropLast","each","has","in","walk"];var a=["similar","min","max","zip","map","hasChain","select","reject","flatten","reduce","sum","multiply","all","every","any","some","filter","compact"];var o=["size","count","each","has","in"];var f=function(r){if(!n[r]){n[r]=function(){i.call(arguments,this);return u[r].apply(u,arguments)}}};var c=function(r){if(!t[r]){t[r]=function(){i.call(arguments,this);return u[r].apply(u,arguments)}}};var l=function(r){if(!Object.prototype[r]){Object.prototype[r]=function(){i.call(arguments,this);return u[r].apply(u,arguments)}}};u.each(r,f);u.each(e,f);u.each(a,c);u.each(e,c);u.each(o,l)};u.extend=function(r){var e;for(e in r){if(r.hasOwnProperty(e)){u[e]=r[e];F(e,r[e])}}};var U=function(r){this._wrapped=r};u.prototype=U.prototype;var q=function(r,e){return e?u(r).begin():r};var F=function(r,e){U.prototype[r]=function(){i.call(arguments,this._wrapped);return q(e.apply(u,arguments),this._chain)}};(function(){var r;for(r in u){if(u.hasOwnProperty(r)){F(r,u[r])}}})();U.prototype.begin=function(){this._chain=true;return this};U.prototype["end"]=function(){return this._wrapped};e.jii=u}).call(this);